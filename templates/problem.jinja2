{% extends 'base.jinja2' %}
{% from 'components/problem.jinja2' import problem_view with context %}

{% block title %}Problem #{{ problem.pk }} - {% endblock %}

{% block content %}

  <div class="bd-pageheader">
    <div class="container">
      <h1>Problem #{{ problem.pk }}</h1>
    </div>
  </div>
  <div class="container">
    {{ problem_view(problem.title, problem.total_accept_number, problem.total_submit_number, False) }}

    {% if user.is_authenticated() %}
      <hr style="margin-bottom: 2em;">
      <h3>Submit your code</h3>
      {% include 'components/message.jinja2' %}
      <form class="form" action="{{ request.path }}" method="post">
        {% csrf_token %}
        <div class="form-group">
          <label class="control-label">{{ form.lang.label }}</label>
          {{ render_field(form.lang, {'class': 'form-control'}) }}
        </div>
        <div class="form-group {% if form.code.errors %}has-error{% endif %}">
          <label class="control-label">{{ form.code.label }}</label>
          {{ render_field(form.code, {'class': 'form-control code-submit', 'rows': "18", "spellcheck": "false"}) }}
          {% for error in form.code.errors %}
            <span id="help-block" class="help-block">{{ error | escape }}</span>
          {% endfor %}
        </div>
        <div class="form-group">
          <button type="submit" class="btn btn-primary">Submit</button>
        </div>
      </form>
    {% endif %}
  </div>

  {% include 'components/code_submit_support.jinja2' %}
  {% include 'components/math_support.jinja2' %}

  <script>
  $('form').submit(function(){
    $(this).find('button[type=submit]').prop('disabled', true);
  });
  </script>

{% endblock %}
